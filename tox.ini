[tox]
envlist = py311
isolated_build = True

[testenv]
basepython = python3.11
whitelist_externals = 
    git
    cmake
    bazel
    pipenv
    pip
    pytest

commands_pre =
    # Update pip and install pipenv
    pip install --upgrade pip
    pip install pipenv
    pipenv install --verbose

    # Initialize and update submodules
    git submodule update --init --recursive

    # Install CMake and Bazel (assuming Homebrew on macOS, adjust for your platform)
    brew install cmake
    brew install bazel

commands =
    pip install .
    pipenv run pytest tests/

# Uncomment this to run pytest excluding certain tests
# commands =
#     pip install .
#     pipenv run pytest tests/ --ignore=tests/cpp/PyMatching
